<div class="packForm">
	<ngx-spinner bdColor = "rgba(0, 0, 0, 0.8)" size = "large" color = "#fff" type = "pacman" [fullScreen] = "true"><p style="color: white" > Loading... </p></ngx-spinner>
	<mat-card>
		<div>
			<h1>Update Packaging Details</h1>
		</div>
		<form [formGroup]="packagingForm" novalidate (ngSubmit)="dispatchDataUpdate()">
			<div class="bomFileForm">
				<div>
					<div class="jobCardForm">
						<div fxLayout="row" fxFlexFill fxLayoutGap="20px">
							<div fxFlex="25" fxFlexAlign="center">
								<mat-form-field appearance="outline">
									<mat-label>Project</mat-label>
									<mat-select name="project" formControlName="project">
										<mat-option *ngFor="let project of projectList" [value]="project.id">
											{{project.title}}
										</mat-option>
									</mat-select>
									<mat-error *ngIf="packagingForm.controls['project'].hasError('required')">
										Project is <strong>required</strong>
									</mat-error>
								</mat-form-field>
							</div>
							<div fxFlex="25" fxFlexAlign="center">
								<mat-form-field appearance="outline">
									<mat-label>Prepared by:</mat-label>
									<mat-select formControlName="prepared">
										<mat-option *ngFor="let user of userList" [value]="user.id">
											{{user.first_name}}
										</mat-option>
									</mat-select>
									<mat-error *ngIf="packagingForm.controls['prepared'].hasError('required')">
										Prepared is <strong>required</strong>
									</mat-error>
								</mat-form-field>
							</div>
							<div fxFlex="25" fxFlexAlign="center">
								<mat-form-field class="full-width" appearance="outline">
									<mat-label>Checked by:</mat-label>
									<mat-select formControlName="checked">
										<mat-option *ngFor="let user of userList" [value]="user.id">
											{{user.first_name}}
										</mat-option>
									</mat-select>
									<mat-error *ngIf="packagingForm.controls['checked'].hasError('required')">
										Authorized is <strong>required</strong>
									</mat-error>
								</mat-form-field>
							</div>
							<div fxFlex="25" fxFlexAlign="center">
								<mat-form-field class="full-width" appearance="outline">
									<mat-label>lr</mat-label>
									<input type='number' matInput  formControlName="lr" >
									<mat-error *ngIf="packagingForm.controls['lr'].hasError('required')">
										lr is <strong>required</strong>
									</mat-error>
								</mat-form-field>
							</div>
						</div>
						<div fxLayout="row" fxFlexFill fxLayoutGap="20px">
							<div fxFlex="25" fxFlexAlign="center">
								<mat-form-field class="full-width" appearance="outline">
									<mat-label>Date</mat-label>
									<input matInput [matDatepicker]="picker" formControlName="date">
									<mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
									<mat-datepicker #picker></mat-datepicker>
									<mat-error *ngIf="packagingForm.controls['date'].hasError('required')">
										Date is <strong>required</strong>
									</mat-error>
								</mat-form-field>
							</div>
							<div fxFlex="25" fxFlexAlign="center">
								<mat-form-field appearance="outline">
									<mat-label>Vehicle</mat-label>
									<mat-select name="vehicle" formControlName="vehicle">
										<mat-option *ngFor="let vehicle of vehicleList" [value]="vehicle.id">
											{{vehicle.number}}
										</mat-option>
									</mat-select>
									<mat-error *ngIf="packagingForm.controls['vehicle'].hasError('required')">
										Vehicle is <strong>required</strong>
									</mat-error>
								</mat-form-field>
							</div>

							<div fxFlex="25" fxFlexAlign="center">
								<mat-form-field appearance="outline">
									<mat-label>Driver</mat-label>
									<mat-select name="driver" formControlName="driver">
										<mat-option *ngFor="let driver of driverList" [value]="driver.id">
											{{driver.name}}
										</mat-option>
									</mat-select>
									<mat-error *ngIf="packagingForm.controls['driver'].hasError('required')">
										Driver is <strong>required</strong>
									</mat-error>
								</mat-form-field>
							</div>

							<div fxFlex="25" fxFlexAlign="center">
								<mat-form-field appearance="outline">
									<mat-label>Transporter</mat-label>
									<mat-select name="transport" formControlName="transporter">
										<mat-option *ngFor="let transport of transportList" [value]="transport.id">
											{{transport.name}}
										</mat-option>
									</mat-select>
									<mat-error *ngIf="packagingForm.controls['transporter'].hasError('required')">
										Transporter is <strong>required</strong>
									</mat-error>
								</mat-form-field>
							</div>
						</div>
					</div> 
				</div>
			</div>
			
			<table mat-table [dataSource]="dataSource" class="mat-elevation-z8 ">

					
				<ng-container matColumnDef="width">
					<th mat-header-cell *matHeaderCellDef >Width</th>
					<td mat-cell *matCellDef="let element"> {{element.width}} </td>
				</ng-container>

				<ng-container matColumnDef="length">
					<th mat-header-cell *matHeaderCellDef >Length</th>
					<td mat-cell *matCellDef="let element"> {{element.length}} </td>
				</ng-container>

				<!-- unit_weight Column -->
				<ng-container matColumnDef="unit_weight">
					<th mat-header-cell *matHeaderCellDef >Unit Wt</th>
					<td mat-cell *matCellDef="let element"> {{element.unit_weight}} </td>
				</ng-container>

				<ng-container matColumnDef="weight">
					<th mat-header-cell *matHeaderCellDef >Weight</th>
					<td mat-cell *matCellDef="let element"> {{element.total_weight}} </td>
				</ng-container>

				<ng-container matColumnDef="piece_weight">
					<th mat-header-cell *matHeaderCellDef >Pc Wt</th>
					<td mat-cell *matCellDef="let element"> {{element.piece_weight}} </td>
				</ng-container>

				<ng-container matColumnDef="quantity">
					<th mat-header-cell *matHeaderCellDef >Qty</th>
					<td mat-cell *matCellDef="let element"> {{element.quantity}} </td>
				</ng-container>

				<ng-container matColumnDef="tower_quantity">
					<th mat-header-cell *matHeaderCellDef >Tower Qty</th>
					<td mat-cell *matCellDef="let element"> {{element.tower_quantity}} </td>
				</ng-container>

				<ng-container matColumnDef="operation">
					<th mat-header-cell *matHeaderCellDef >Operation</th>
					<td mat-cell *matCellDef="let element"> {{element.operation}} </td>
				</ng-container>

				<ng-container matColumnDef="n">
					<th mat-header-cell *matHeaderCellDef >N</th>
					<td mat-cell *matCellDef="let element"> {{element.n || 0.0}} </td>
				</ng-container>

				<ng-container matColumnDef="b">
					<th mat-header-cell *matHeaderCellDef >B</th>
					<td mat-cell *matCellDef="let element"> {{element.b || 0.0}} </td>
				</ng-container>

				<ng-container matColumnDef="hab">
					<th mat-header-cell *matHeaderCellDef >HAB</th>
					<td mat-cell *matCellDef="let element"> 
						<span >{{element.hab || 0.0}}</span>
					</td>
				</ng-container>

				<ng-container matColumnDef="d">
					<th mat-header-cell *matHeaderCellDef >D</th>
					<td mat-cell *matCellDef="let element"> {{element.d || 0.0}} </td>
				</ng-container>

				<ng-container matColumnDef="remark">
					<th mat-header-cell *matHeaderCellDef >Remark</th>
					<td mat-cell *matCellDef="let element"> {{element.remark || 'No remark'}} </td>
				</ng-container>

				<!-- <ng-container matColumnDef="action">
					<th mat-header-cell *matHeaderCellDef >Action</th>
					<td mat-cell *matCellDef="let element; let i = index"><button  mat-icon-button color="warn" (click)=delete(i) ><mat-icon>delete</mat-icon></button> </td>
				</ng-container> -->
			
				<tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
				<tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
			</table>
			
			<mat-dialog-actions align="end">
				<button mat-raised-button color="primary" type="submit"  [disabled]="!packagingForm.valid">Save</button>
				<!-- <button mat-button mat-dialog-close>Cancel</button> -->
			</mat-dialog-actions>
		</form>
	</mat-card>
</div>

